
jQuery.fn.extend({texyla:function(options){this.filter("textarea").each(function(){new Texyla(this,options);});}});jQuery.extend({texyla:function(options){jQuery("textarea.texyla").texyla(options);}});function Texyla(textarea,options){this.options=jQuery.extend({},this.defaultOptions,options||{});this.textarea=jQuery(textarea);if(this.textarea.data("texyla"))return false;this.textarea.data("texyla",true);var lng=this.options.language;if(!this.languages[lng]){this.error("Language '"+lng+"' is not loaded.");return false;}
this.lng=this.languages[lng];this.baseDir=this.options.baseDir||this.baseDir;this.options.iconPath=this.expand(this.options.iconPath);this.options.previewPath=this.expand(this.options.previewPath);this.texy=new Texy(this);this.wrap();for(var i=0;i<this.initPlugins.length;i++){this.initPlugins[i].apply(this);}};Texyla.prototype.expand=function(text,variable){text=text.replace("%texyla_base%",this.baseDir);if(variable){text=text.replace("%var%",variable);}
return text;};Texyla.prototype.initPlugins=[];jQuery.texyla.setDefaults=function(defaults){jQuery.extend(Texyla.prototype.defaultOptions,defaults);};jQuery.texyla.initPlugin=function(pluginInit){Texyla.prototype.initPlugins.push(pluginInit);};jQuery.texyla.addButton=function(name,func){Texyla.prototype.buttons[name]=func;};jQuery.texyla.extend=function(extendingObject){jQuery.extend(Texyla.prototype,extendingObject);};jQuery.texyla.addStrings=function(lng,strings){if(!Texyla.prototype.languages[lng]){Texyla.prototype.languages[lng]={};}
jQuery.extend(Texyla.prototype.languages[lng],strings);};jQuery.texyla.setErrorHandler=function(handler){Texyla.prototype.error=handler;};Texyla.prototype.submit=function(){var f=this.textarea.get(0).form;function submitnout(){if(f.submit.tagName==undefined){f.submit();}else{f.submit.click();}}
if(typeof f.onsubmit=='function'){if(f.onsubmit()){submitnout();}}else{submitnout();}};Texyla.prototype.error=function(message){alert("Error: "+message);};Texyla.prototype.baseDir=jQuery("head script:last").attr("src").replace(/(\/js)?\/?[\w-]+\.js$/,'');Texyla.prototype.languages={};Texyla.prototype.defaultOptions={width:null,padding:5,texyCfg:"",toolbar:['bold','italic',null,'ul','ol',null,'link',null,'emoticon','symbol',"img","table",null,['web']],bottomLeftToolbar:['edit','preview'],bottomRightEditToolbar:['syntax'],bottomRightPreviewToolbar:['submit'],buttonType:"span",tabs:false,defaultView:"edit",iconWidth:16,iconHeight:16,baseDir:null,iconPath:"%texyla_base%/icons/%var%.png",previewPath:null,language:"cs"};function Selection(ta){this.textarea=ta;};Selection.prototype={lineFeedFormat:null,lineFeedKnown:false,isIe:function(){if(this.textarea.selectionStart||this.textarea.selectionStart===0){return false;}else if(document.selection){return true;}
return null;},tag:function(firstText,secondText){this.update();this.changeSelection(firstText+this.text()+secondText);if(this.isCursor()){this.select(this.start+firstText.length,0);}else{this.select(this.start,firstText.length+this.length()+secondText.length);}},replace:function(replacement){if(replacement===null)return;this.update();this.changeSelection(replacement);this.select(this.start,replacement.length);},trimSelect:function(){this.update();if(this.text().substring(this.length(),this.length()-1)==" "){this.select(this.start,this.length()-1);}
return this.update();},phrase:function(firstText,secondText){this.trimSelect().tag(firstText,secondText?secondText:firstText);},changeSelection:function(replacement){var scrolled=this.textarea.scrollTop;var val=this.textarea.value;this.textarea.value=val.substring(0,this.start)+replacement+val.substring(this.end);this.textarea.scrollTop=scrolled;},lf:function(){if(this.lineFeedKnown)return this.lineFeedFormat;var unix=this.textarea.value.indexOf('\n');var mac=this.textarea.value.indexOf('\r');var win=this.textarea.value.indexOf('\r\n');var lineFeed=null;if(unix>=0)lineFeed='\n';if(mac>=0)lineFeed='\r';if(win>=0)lineFeed='\r\n';if(lineFeed){this.lineFeedFormat=lineFeed;this.lineFeedKnown=true;return lineFeed;}
return document.selection?'\r\n':'\n';},update:function(){this.textarea.focus();if(this.isIe()){var range=document.selection.createRange();var bookmark=range.getBookmark();var contents=this.textarea.value;var originalContents=contents;var marker="[~M~A~R~K~E~R~]";while(contents.indexOf(marker)!=-1){marker=marker+Math.random();}
range.text=marker+range.text+marker;contents=this.textarea.value;this.start=contents.indexOf(marker);contents=contents.replace(marker,"");this.end=contents.indexOf(marker);this.textarea.value=originalContents;range.moveToBookmark(bookmark);range.select();}else{this.start=this.textarea.selectionStart;this.end=this.textarea.selectionEnd;}
return this;},length:function(){return this.end-this.start;},text:function(){return this.textarea.value.substring(this.start,this.end);},isCursor:function(){return this.start==this.end;},select:function(from,length){if(this.isIe()){var lfCount=this.textarea.value.substring(0,from).split("\r\n").length-1;from-=lfCount;this.textarea.focus();this.textarea.select();var ieSelected=document.selection.createRange();ieSelected.collapse(true);ieSelected.moveStart("character",from);ieSelected.moveEnd("character",length);ieSelected.select();}else{this.textarea.selectionStart=from;this.textarea.selectionEnd=from+length;}
this.textarea.focus();},selectBlock:function(){this.update();var lf=this.lf();var ta=this.textarea;var workFrom=ta.value.substring(0,this.start).lastIndexOf(lf);if(workFrom!==-1)workFrom+=lf.length;var from=Math.max(0,workFrom);var len=ta.value.substring(from,this.start).length+this.length();var fromSelectionEnd=ta.value.substring(this.end,ta.value.length);var lineFeedPos=fromSelectionEnd.indexOf(lf);len+=lineFeedPos==-1?fromSelectionEnd.length:lineFeedPos;this.select(from,len);return this.update();}};function Texy(texyla){this.textarea=texyla.textarea.get(0);this.texyla=texyla;};Texy.prototype=jQuery.extend({},Selection.prototype,{bold:function(){this.trimSelect();var text=this.text();if(text.match(/^\*\*.*\*\*$/)){this.replace(text.substring(2,text.length-2));}else{this.tag("**","**");}},italic:function(){this.trimSelect();var text=this.text();if(text.match(/^\*\*\*.*\*\*\*$/)||text.match(/^\*[^*]+\*$/)){this.replace(text.substring(1,text.length-1));}else{this.tag("*","*");}},block:function(what){this.tag('/--'+what+this.lf(),this.lf()+'\\--');},link:function(addr){if(addr)this.phrase('"','":'+addr);},acronym:function(title){this.update();if(title){if(this.text().match(/^[a-zA-ZěščřžýáíéúůĚŠČŘŽÝÁÍÉÚŮ]{2,}$/)){this.tag('','(('+title+'))');}else{this.phrase('"','"(('+title+'))');}}},line:function(){this.update();var lf=this.lf();var lineText=lf+lf+'-------------------'+lf+lf;if(this.isCursor())this.tag(lineText,'');else this.replace(lineText);},align:function(type){this.update();var lf=this.lf();var start='.'+type+lf;var newPar=lf+lf;var found=this.textarea.value.substring(0,this.start).lastIndexOf(newPar);var beforePar=found+newPar.length;if(found==-1){this.textarea.value=start+this.textarea.value;}else{this.textarea.value=this.textarea.value.substring(0,beforePar)+start+this.textarea.value.substring(beforePar);}
this.select(this.start+start.length,this.length());},_toRoman:function(num){num=Math.min(parseInt(num,10),5999);var mill=['','M','MM','MMM','MMMM','MMMMM'],cent=['','C','CC','CCC','CD','D','DC','DCC','DCCC','CM'],tens=['','X','XX','XXX','XL','L','LX','LXX','LXXX','XC'],ones=['','I','II','III','IV','V','VI','VII','VIII','IX'],m,c,t,r=function(n){n=(num-(num%n))/n;return n;};m=r(1000);num=num%1000;c=r(100);num=num%100;t=r(10);return mill[m]+cent[c]+tens[t]+ones[num%10];},_toLetter:function(n){var alphabet=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return alphabet[Math.max(0,Math.min(n,alphabet.length)-1)];},list:function(type){this.selectBlock();var lf=this.lf();var lines=this.text().split(lf);var lineCt=this.isCursor()?3:lines.length;var replacement='';for(var i=1;i<=lineCt;i++){var bullet={ul:'-',ol:i+')',bq:'>',indent:'',romans:this._toRoman(i)+')',smallRomans:this._toRoman(i).toLowerCase()+')',smallAlphabet:this._toLetter(i)+')',bigAlphabet:this._toLetter(i).toUpperCase()+')'};replacement+=bullet[type]+' '+(!this.isCursor()?lines[i-1]:'')+(i!=lineCt?lf:'');if(this.isCursor()&&i===1)var curPos=replacement.length-1;}
if(this.isCursor()){this.tag(replacement.substring(0,curPos),replacement.substring(curPos));}else{this.replace(replacement);}},indent:function(){this.list("indent");},unindent:function(){this.selectBlock();var lines=this.text().split(this.lf());var replacement=[];for(var i=0;i<lines.length;i++){var first=lines[i].substring(0,1);if(first==" "||first=="\t"){replacement.push(lines[i].substring(1,lines[i].length));}else{replacement.push(lines[i]);}}
this.replace(replacement.join(this.lf()));},heading:function(type){this.selectBlock();var lf=this.lf();function underline(len,type){var txt='';for(var i=0;i<Math.max(3,len);i++){txt+=type;}
return txt;}
if(this.isCursor()){var headingText=prompt(this.texyla.lng.texyHeadingText,'');if(headingText){this.tag(headingText+lf+underline(headingText.length,type)+lf,'');}}else{this.tag('',lf+underline(this.length(),type));}},img:function(src,alt,align,descr){var imgT='';if(align=='<>'){imgT+=this.lf()+'.<>'+this.lf();align=false;}
imgT+='[* '+src+' ';imgT+=alt?'.('+alt+') ':'';imgT+=(align?align:'*')+']';imgT+=descr?' *** '+alt:'';this.replace(imgT);},table:function(cols,rows,header){var lf=this.lf();var tabTxt=lf;for(var i=0;i<rows;i++){if(header==='n'&&i<2){tabTxt+='|';for(var j=0;j<cols;++j){tabTxt+='--------';}
tabTxt+=lf;}
for(j=0;j<cols;j++){if(header==='l'&&j===0){tabTxt+="|* \t";}else{tabTxt+="| \t";}
if(i===0&&j===0)var curPos=tabTxt.length-1;}
tabTxt+='|'+lf;}
tabTxt+=lf;this.tag(tabTxt.substring(0,curPos),tabTxt.substring(curPos));}});Texyla.prototype.buttons={h1:function(){this.texy.heading('#');},h2:function(){this.texy.heading('*');},h3:function(){this.texy.heading('=');},h4:function(){this.texy.heading('-');},bold:function(){this.texy.bold();},italic:function(){this.texy.italic();},del:function(){this.texy.phrase('--');},center:function(){this.texy.align('<>');},left:function(){this.texy.align('<');},right:function(){this.texy.align('>');},justify:function(){this.texy.align('=');},ul:function(){this.texy.list('ul');},ol:function(){this.texy.list('ol');},olRomans:function(){this.texy.list('romans');},olRomansSmall:function(){this.texy.list('smallRomans');},olAlphabetSmall:function(){this.texy.list('smallAlphabet');},olAlphabetBig:function(){this.texy.list('bigAlphabet');},blockquote:function(){this.texy.list('bq');},indent:function(){this.texy.indent();},unindent:function(){this.texy.unindent();},sub:function(){this.texy.phrase('__');},sup:function(){this.texy.phrase('^^');},link:function(){this.texy.link(prompt(this.lng.linkUrl,'http://'));},acronym:function(){this.texy.acronym(prompt(this.lng.acronymTitle,''));},hr:function(){this.texy.line();},code:function(){this.texy.block('code');},codeHtml:function(){this.texy.block('code html');},codeCss:function(){this.texy.block('code css');},codeJs:function(){this.texy.block('code js');},codePhp:function(){this.texy.block('code php');},codeSql:function(){this.texy.block('code sql');},codeInline:function(){this.texy.phrase('`');},html:function(){this.texy.block('html');},notexy:function(){this.texy.phrase("''","''");},web:function(){window.open('http://texyla.janmarek.net/');},syntax:function(){window.open(this.lng.syntaxUrl);},div:function(){this.texy.block('div');},comment:function(){this.texy.block('comment');},text:function(){this.texy.block('text');},preview:function(){this.view("preview");},htmlPreview:function(){this.view("htmlPreview");},edit:function(){this.view("edit");},submit:function(){this.submit();}};Texyla.prototype.wrap=function(){this.container=this.textarea.wrap('<div class="texyla"></div>').parent();var containerWidth=this.options.width||this.textarea.get(0).offsetWidth||this.textarea.width();this.container.width(containerWidth);this.editDiv=this.textarea.wrap('<div class="textarea-container"></div>').parent().wrap('<div class="edit-div"></div>').parent();if(this.textarea.get(0).offsetWidth>0){this.textarea.width(containerWidth);var delta=this.textarea.get(0).offsetWidth-containerWidth;}else{var delta=0;}
this.textarea.width(containerWidth-delta-2*this.options.padding);this.textareaHeight=this.textarea.get(0).offsetHeight;this.previewDiv=jQuery('<div class="preview-div"></div>').insertAfter(this.editDiv);this.previewDiv.prepend('<div class="view-header" style="background-image: url(\''+
this.expand(this.options.iconPath,"preview")+'\');">'+
this.lng.btn_preview+'</div>');this.preview=jQuery('<div class="preview"></div>').appendTo(this.previewDiv).wrap('<div class="preview-wrapper ui-widget-content"></div>');this.htmlPreviewDiv=jQuery('<div class="html-preview-div"></div>').insertAfter(this.previewDiv);this.htmlPreviewDiv.prepend('<div class="view-header" '+'style="background-image: url(\''+this.expand(this.options.iconPath,"htmlPreview")+'\');">'+
this.lng.btn_htmlPreview+'</div>');this.htmlPreview=jQuery('<pre class="html-preview"></pre>').appendTo(this.htmlPreviewDiv).wrap('<div class="preview-wrapper ui-widget-content"></div>');this.wait=jQuery('<div class="preview-wait">'+this.lng.wait+'</div>');this.createToolbar();this.createBottomToolbar();this.view(this.options.defaultView,true);};Texyla.prototype.createToolbar=function(){var toolbar=jQuery('<ul class="toolbar"></ul>').prependTo(this.editDiv);var item,toolbar2;for(var i=0;i<this.options.toolbar.length;i++){item=this.options.toolbar[i];if(typeof item=="string"){jQuery("<span title='"+this.lng["btn_"+item]+"'>"+"<img src='"+this.expand(this.options.iconPath,item)+"' width='"+this.options.iconWidth+"' height='"+this.options.iconHeight+"'>"+"</span>").click(this.clickButton(item)).appendTo("<li class='btn_"+item+"'></li>").parent().appendTo(toolbar);}
else if(item===null){toolbar.append("<li class='separator'></li>");}
else if(jQuery.isArray(item)){toolbar2=jQuery("<ul class='ui-widget-content ui-corner-all'></ul>");var menuTimeout;toolbar2.appendTo("<li class='menu'></li>").parent().mouseover(function(){clearTimeout(menuTimeout);jQuery(this).siblings().find("ul:visible").fadeOut("fast");jQuery(this).find("ul").show();}).mouseout(function(){var _this=this;menuTimeout=setTimeout(function(){jQuery(_this).find("ul").fadeOut("fast");},300);}).appendTo(toolbar);for(var j=0;j<item.length;j++){jQuery("<li class='btn_"+item[j]+" ui-corner-all'>"+"<span style='background-image: url(\""+this.expand(this.options.iconPath,item[j])+"\");'>"+
this.lng["btn_"+item[j]]+"</span></li>").hover(function(){jQuery(this).addClass("ui-state-hover");},function(){jQuery(this).removeClass("ui-state-hover");}).click(this.clickButton(item[j])).appendTo(toolbar2);}}else if(typeof(item)=="object"&&item.type=="label"){var text=item.translatedText?this.lng[item.translatedText]:item.text;toolbar.append("<li class='label ui-state-disabled'>"+text+"</li>");}}};Texyla.prototype.clickButton=function(name){var _this=this;if(name in this.buttons){return function(e){_this.buttons[name].call(_this,e);};}else{return function(){_this.error('Function "'+name+'" is not supported!');};}};Texyla.prototype.createBottomToolbar=function(){var bottomToolbar=jQuery("<div class='bottom-toolbar'></div>").appendTo(this.container);this.leftToolbar=jQuery("<div class='left-toolbar'></div>").appendTo(bottomToolbar);var right=jQuery('<div class="right-toolbar"></div>').appendTo(bottomToolbar);this.rightEditToolbar=jQuery("<div class='right-edit-toolbar'></div>").appendTo(right);this.rightPreviewToolbar=jQuery("<div class='right-preview-toolbar'></div>").appendTo(right);if(this.options.tabs){this.leftToolbar.addClass("tabs");}else if(this.options.buttonType=="span"){this.leftToolbar.addClass("span-tb");}
if(this.options.buttonType=="span"){right.addClass("span-tb");}
var _this=this;function createButton(icon,name,func,tabs){var iconUrl=_this.expand(_this.options.iconPath,icon);if(_this.options.buttonType=="span"||tabs){return jQuery("<span class='btn btn_"+icon+" ui-state-default "+(tabs?"ui-corner-bottom":"ui-corner-all")+"'>"+"<span class='btn-left'></span><span class='btn-middle'>"+"<span style='background-image: url(\""+iconUrl+"\");' class='icon-span'>"+name+"</span>"+"</span><span class='btn-right'></span>"+"</span>").click(func).hover(function(){jQuery(this).addClass("ui-state-hover");},function(){jQuery(this).removeClass("ui-state-hover");});}else{return jQuery("<button type='button' class='btn_"+icon+"'>"+"<img src='"+iconUrl+"' width='"+_this.options.iconWidth+"' height='"+_this.options.iconHeight+"'>"+" "+name+"</button>").click(func);}};function insertButtons(toolbar,buttons,tabs){for(var i=0;i<buttons.length;i++){createButton(buttons[i],_this.lng["btn_"+buttons[i]],_this.clickButton(buttons[i]),tabs).appendTo(toolbar);}};insertButtons(this.leftToolbar,this.options.bottomLeftToolbar,this.options.tabs);insertButtons(this.rightEditToolbar,this.options.bottomRightEditToolbar);insertButtons(this.rightPreviewToolbar,this.options.bottomRightPreviewToolbar);};Texyla.prototype.view=function(type,first){var taVal=this.textarea.val();if(type!="edit"&&taVal==""){if(first){this.view("edit");return;}
alert(this.lng.viewEmpty);this.textarea.focus();return;}
switch(type){case"preview":this.previewDiv.show();this.htmlPreviewDiv.hide();this.editDiv.hide();this.rightPreviewToolbar.show();this.rightEditToolbar.hide();break;case"htmlPreview":this.previewDiv.hide();this.htmlPreviewDiv.show();this.editDiv.hide();this.rightPreviewToolbar.show();this.rightEditToolbar.hide();break;case"edit":this.previewDiv.hide();this.htmlPreviewDiv.hide();this.editDiv.show();this.rightPreviewToolbar.hide();this.rightEditToolbar.show();break;}
if(type!="edit"){var height=this.textarea.get(0).offsetHeight||this.textareaHeight;if(height){var curPrev=this[type=="preview"?"preview":"htmlPreview"].parent();curPrev.height(height);var delta=curPrev.get(0).offsetHeight-height;this.container.find("div.preview-wrapper").height(height-delta);}else{this.container.find("div.preview-wrapper").height("auto");}}
if(this.options.tabs){var tabs=this.leftToolbar;tabs.find(".ui-state-active").removeClass("ui-state-active");tabs.find(".btn_"+type).addClass("ui-state-active");}else{var views=["preview","htmlPreview","edit"];for(var i=0;i<views.length;i++){if(views[i]==type){this.container.find(".btn_"+type).hide();}else{this.container.find(".btn_"+views[i]).show();}}}
if(type!="edit"&&this.lastPreviewedTexy!=taVal){var _this=this;function onLoad(data){_this.preview.html(data).show();_this.htmlPreview.text(data.replace(new RegExp("\n","g"),_this.texy.lf())).show();if(typeof jush!='undefined'){_this.htmlPreview.html(jush.highlight("htm",data));}
_this.wait.hide();};this.lastPreviewedTexy=taVal;var parent=this[type=="preview"?"preview":"htmlPreview"].parent();parent.prepend(this.wait);this.wait.show().css({marginTop:(parent.get(0).offsetHeight-this.wait.get(0).offsetHeight)/2,marginLeft:(parent.get(0).offsetWidth-this.wait.get(0).offsetWidth)/2});this.preview.hide();this.htmlPreview.hide();jQuery.post(this.options.previewPath,{texy:taVal,cfg:this.options.texyCfg},onLoad,"html");}};jQuery.fn.extend({ajaxUpload:function(callback){if(!this.is("form"))return;if(!arguments.callee.count){arguments.callee.count=0;}
var target="ajaxUploadFrame"+(++arguments.callee.count);var iframe=jQuery('<iframe src="" width="1" height="1" frameborder="0" '+'name="'+target+'"></iframe>');iframe.css({visibility:"hidden",position:"absolute",left:"-1000px",top:"-1000px"});iframe.appendTo("body");iframe.load(function(){jQuery.event.trigger("ajaxComplete");var iframeEl=iframe.get(0);var body;if(iframeEl.contentDocument){body=iframeEl.contentDocument.body;}else{body=iframeEl.contentWindow.document.body;}
var content=jQuery(body).text();if(!content){callback();}else{eval("var data = "+content+";");callback(data);}
setTimeout(function(){iframe.remove()},1000);});this.attr({target:target,method:"post",enctype:"multipart/form-data"}).submit();jQuery.event.trigger("ajaxStart");}});jQuery.texyla.initPlugin(function(){this.openedWindows={};});jQuery.texyla.addWindow=function(name,options){Texyla.prototype.windowConfigs[name]=options;if(options.dimensions){var defaults={};defaults[name+"WindowDimensions"]=options.dimensions;jQuery.texyla.setDefaults(defaults);}
jQuery.texyla.addButton(name,function(){this.openWindow(name);});};jQuery.texyla.extend({windowConfigs:{},openWindow:function(name){if(typeof(jQuery.fn.dialog)!="function"){this.error("jQuery UI plugin Dialog is not loaded.");return false;}
if(!Texyla.prototype.windowConfigs[name]){this.error("Window "+name+" is not defined.");return false;}
if(this.isWindowOpened(name)){return this.getWindow(name).dialog("moveToTop");}
var config=Texyla.prototype.windowConfigs[name];var el=config.createContent.call(this);this.openedWindows[name]=el;var options=config.options||{};options.title=config.title?config.title:this.lng["win_"+name];var dimensions=this.options[name+"WindowDimensions"];if(dimensions){options.width=dimensions[0];options.height=dimensions[1];}
var _this=this;if(config.action){options.buttons={};options.buttons[this.lng.windowOk]=function(){config.action.call(_this,el);if(!config.stayOpened){_this.closeWindow(name);}};options.buttons[this.lng.windowCancel]=function(){_this.closeWindow(name);};}
options.close=function(){_this.closeWindow(name);};el.dialog(options);el.find("input:first").focus();return el;},closeWindow:function(name){this.openedWindows[name].dialog("destroy").remove();this.openedWindows[name]=null;},isWindowOpened:function(name){return this.openedWindows[name]?true:false;},getWindowAction:function(name){return Texyla.prototype.windowConfigs[name].action;},getWindow:function(name){return this.openedWindows[name]?this.openedWindows[name]:null;}});jQuery.texyla.addStrings("cs",{btn_h1:"Nejv\u011bt\u0161í nadpis",btn_h2:"Velký nadpis",btn_h3:"St\u0159ední nadpis",btn_h4:"Nejmen\u0161í nadpis",btn_bold:"Tu\u010dn\u011b",btn_italic:"Kurzíva",btn_del:"P\u0159e\u0161krtnuto",btn_center:"Zarovnání na st\u0159ed",btn_left:"Zarovnání vlevo",btn_right:"Zarovnání vpravo",btn_justify:"Zarovnání do bloku",btn_ul:"Seznam",btn_ol:"\u010císlovaný seznam",btn_olRomans:"\u0158ímské \u010díslování",btn_olRomansSmall:"Malé \u0159ímské \u010díslování",btn_olAlphabetSmall:"Malá abeceda",btn_olAlphabetBig:"Velká abeceda",btn_blockquote:"Bloková citace",btn_sub:"Dolní index",btn_sup:"Horní index",btn_link:"Odkaz",btn_acronym:"Vysv\u011btlení zkratky",btn_hr:"\u010cára",btn_code:"Kód",btn_codeHtml:"Kód html",btn_codeCss:"Kód CSS",btn_codeJs:"Kód javascript",btn_codePhp:"Kód php",btn_codeSql:"Kód SQL",btn_comment:"Komentá\u0159",btn_div:"Blok div",btn_text:"Text",btn_codeInline:"Inline kód",btn_html:"HTML",btn_notexy:"Inline text",btn_edit:"Upravit",btn_preview:"Náhled",btn_htmlPreview:"HTML",btn_syntax:"Texy nápov\u011bda",btn_submit:"Odeslat",btn_web:"Web editoru Texyla",texyHeadingText:"Text nadpisu",acronymTitle:"Titulek",linkUrl:"Adresa odkazu",wait:"Prosím \u010dekejte",viewEmpty:"Textové pole je prázdné!",windowOk:"OK",windowClose:"Zav\u0159ít",windowCancel:"Storno",windowCloseAfterInsert:"Zav\u0159ít po vlo\u017eení",syntaxUrl:"http://texy.info/cs/syntax",btn_color:"Barvy",win_color:"Vyberte barvu",colorSelectModeHeading:"Obarvit:",colorSelectModeText:"text",colorSelectModeBackground:'pozadí',btn_emoticon:"Smajlík",win_emoticon:"Vlo\u017eit smajlík",btn_files:"Soubory",win_files:"Soubory",filesUpload:"Nahrát soubor",win_upload:"Nahrát soubor",filesFilter:"Filtr",filesMkDir:"Vytvo\u0159it adresá\u0159",filesRename:"P\u0159ejmenovat",filesDelete:"Smazat",filesReallyDelete:"Opravdu smazat",filesDirectoryName:"Název slo\u017eky",btn_img:"Obrázek",win_img:"Vlo\u017eit obrázek",imgSrc:"Adresa obrázku",imgAlt:"Popis",imgAlign:"Zarovnání",imgAlignNone:"\u017eádné",imgAlignLeft:"vlevo",imgAlignRight:"vpravo",imgAlignCenter:"na st\u0159ed",imgDescription:"Zobrazit jako popisek",win_link:"Vlo\u017eit odkaz",linkText:"Text odkazu",btn_symbol:"Symbol",win_symbol:"Vlo\u017eit symbol",btn_table:"Tabulka",win_table:"Vlo\u017eit tabulku",tableCols:"Po\u010det sloupc\u016f",tableRows:"Po\u010det \u0159ádek",tableTh:"Hlavi\u010dka",tableThNone:"\u017eádná",tableThTop:"naho\u0159e",tableThLeft:"vlevo",btn_textTransform:"Transformovat text",win_textTransform:"Vyberte transformaci",textTransformLower:"malá písmena",textTransformUpper:"VELKÁ PÍSMENA",textTransformCapitalize:"První Velká",textTransformFirstUpper:"První velké",textTransformUrl:"tvar-webove-adresy",btn_youtube:"YouTube",win_youtube:"YouTube",youtubeUrl:"Vlo\u017ete adresu videa nebo jeho ID",youtubePreview:"Náhled videa",btn_gravatar:"Gravatar",win_gravatar:"Gravatar",gravatarUrl:"Vlo\u017ete email",gravatarPreview:"Náhled"});jQuery.texyla.addStrings("sk",{btn_h1:"Najvä\u010d\u0161í nadpis",btn_h2:"Ve\u013eký nadpis",btn_h3:"Stredný nadpis",btn_h4:"Najmen\u0161í nadpis",btn_bold:"Tu\u010dne",btn_italic:"Kurzíva",btn_del:"Pre\u010diarknuté",btn_center:"Zarovnanie na stred",btn_left:"Zarovnanie v\u013eavo",btn_right:"Zarovnanie vpravo",btn_justify:"Zarovnanie do bloku",btn_ul:"Zoznam",btn_ol:"\u010císlovaný zoznam",btn_olRomans:"Rímske \u010díslovanie",btn_olRomansSmall:"Malé rímske \u010díslovanie",btn_olAlphabetSmall:"Malá abeceda",btn_olAlphabetBig:"Ve\u013eká abeceda",btn_blockquote:"Bloková citácia",btn_sub:"Dolný index",btn_sup:"Horný index",btn_link:"Odkaz",btn_acronym:"Vysvetlenie skratky",btn_hr:"\u010ciara",btn_code:"Kód",btn_codeHtml:"Kód html",btn_codeCss:"Kód CSS",btn_codeJs:"Kód javascript",btn_codePhp:"Kód php",btn_codeSql:"Kód SQL",btn_comment:"Komentár",btn_div:"Blok div",btn_text:"Text",btn_codeInline:"Inline kód",btn_html:"HTML",btn_notexy:"Inline text",btn_edit:"Upravi\u0165",btn_preview:"Náh\u013ead",btn_htmlPreview:"HTML",btn_syntax:"Texy nápoveda",btn_submit:"Odosla\u0165",btn_web:"Web editora Texyla",texyHeadingText:"Text nadpisu",acronymTitle:"Titulok",linkUrl:"Adresa odkazu",wait:"Prosím po\u010dkajte",viewEmpty:"Textové pole je prázdne!",windowOk:"OK",windowClose:"Zavrie\u0165",windowCancel:"Zru\u0161i\u0165",windowCloseAfterInsert:"Zavrie\u0165 po vlo\u017eení",syntaxUrl:'http://texy.info/cs/syntax',btn_color:"Farby",win_color:"Vyberte farbu",colorSelectModeHeading:"Ofarbi\u0165:",colorSelectModeText:"text",colorSelectModeBackground:'pozadie',btn_emoticon:"Smajlík",win_emoticon:"Vlo\u017ei\u0165 smajlíka",btn_files:"Súbory",win_files:"Súbory",filesUpload:"Nahra\u0165",win_upload:"Nahra\u0165 súbor",filesFilter:"Filter",filesMkDir:"Vytvori\u0165 adresár",filesRename:"Premenova\u0165",filesDelete:"Zmaza\u0165",filesReallyDelete:"Naozaj zmaza\u0165",filesDirectoryName:"Názov zlo\u017eky",btn_img:"Obrázok",win_img:"Vlo\u017ei\u0165 obrázok",imgSrc:"Adresa obrázka",imgAlt:"Popis",imgAlign:"Zarovnanie",imgAlignNone:"\u017eiadne",imgAlignLeft:"v\u013eavo",imgAlignRight:"vpravo",imgAlignCenter:"na stred",imgDescription:"Zobrazi\u0165 ako popisok",win_link:"Vlo\u017ei\u0165 odkaz",linkText:"Text odkazu",btn_symbol:"Symbol",win_symbol:"Vlo\u017ei\u0165 symbol",btn_table:"Tabu\u013eka",win_table:"Vlo\u017ei\u0165 tabu\u013eku",tableCols:"Po\u010det stĺpcov",tableRows:"Po\u010det riadkov",tableTh:"Hlavi\u010dka",tableThNone:"\u017eiadna",tableThTop:"hore",tableThLeft:"v\u013eavo",btn_textTransform:"Transformova\u0165 text",win_textTransform:"Vyberte transformáciu",textTransformLower:"malé písmena",textTransformUpper:"VE\u013dKÉ PÍSMENA",textTransformCapitalize:"Prvé Ve\u013eké",textTransformFirstUpper:"Prvé ve\u013ekým",textTransformUrl:"tvar-webovej-adresy",btn_youtube:"YouTube",win_youtube:"YouTube",youtubeUrl:"Vlo\u017ete adresu videa alebo jeho ID",youtubePreview:"Náh\u013ead videa",btn_gravatar:'Gravatar',win_gravatar:'Gravatar',gravatarUrl:"Vlo\u017ete email",gravatarPreview:"Náh\u013ead"});jQuery.texyla.addStrings("en",{btn_h1:"The biggest heading",btn_h2:"Big heading",btn_h3:"Medium heading",btn_h4:"The smallest heading",btn_bold:"Bold",btn_italic:"Italic",btn_del:"Deleted",btn_center:"Center",btn_left:"Align to left",btn_right:"Align to right",btn_justify:"Justify",btn_ul:"List",btn_ol:"Numbered list",btn_olRomans:"Capital roman numbers",btn_olRomansSmall:"Small roman numbers",btn_olAlphabetSmall:"Small letters",btn_olAlphabetBig:"Capital letters",btn_blockquote:"Quotation block",btn_sub:"Lower index",btn_sup:"Upper index",btn_link:"Link",btn_acronym:"Acronym",btn_hr:"Line",btn_code:"Code",btn_codeHtml:"HTML code",btn_codeCss:"CSS code",btn_codeJs:"Javascript code",btn_codePhp:"PHP code",btn_codeSql:"SQL code",btn_comment:"Comment",btn_div:"Div block",btn_text:"Text",btn_codeInline:"Inline code",btn_html:"HTML",btn_notexy:"Inline text",btn_edit:"Edit",btn_preview:"Preview",btn_htmlPreview:"HTML",btn_syntax:"Texy help",btn_submit:"Submit",btn_web:"Texyla's web",texyHeadingText:"Heading text",acronymTitle:"Title",linkUrl:"Link URL",wait:"Wait please",viewEmpty:"Text area is empty!",windowOk:"OK",windowClose:"Close",windowCancel:"Cancel",windowCloseAfterInsert:"Close after insert",syntaxUrl:'http://texy.info/en/syntax',btn_color:"Colors",win_color:"Choose a color",colorSelectModeHeading:"Colorize:",colorSelectModeText:"text",colorSelectModeBackground:'background',btn_emoticon:"Emoticon",win_emoticon:"Insert an emoticon",btn_files:"Files",win_files:"Files",filesUpload:"Upload",win_upload:"File upload",filesFilter:"Filter",filesMkDir:"Create directory",filesRename:"Rename",filesDelete:"Delete",filesReallyDelete:"Really delete",filesDirectoryName:"Directory name",btn_img:"Image",win_img:"Insert an image",imgSrc:"Image's address",imgAlt:"Description",imgAlign:"Alingment",imgAlignNone:"none",imgAlignLeft:"left",imgAlignRight:"right",imgAlignCenter:"center",imgDescription:"Show as a description",win_link:"Insert hyperlink",linkText:"Link text",btn_symbol:"Symbol",win_symbol:"Insert a symbol",btn_table:"Table",win_table:"Insert a table",tableCols:"Number of collumns",tableRows:"Number of rows",tableTh:"Header",tableThNone:"none",tableThTop:"top",tableThLeft:"left",btn_textTransform:"Text transformation",win_textTransform:"Choose type od transformation",textTransformLower:"lower case",textTransformUpper:"UPPER CASE",textTransformCapitalize:"Capitalize",textTransformFirstUpper:"First upper",textTransformUrl:"cool-web-url",btn_youtube:"YouTube",win_youtube:"YouTube",youtubeUrl:"Insert address or ID",youtubePreview:"Preview",btn_gravatar:"Gravatar",win_gravatar:"Gravatar",gravatarUrl:"Insert email",gravatarPreview:"Preview"});jQuery.texyla.initPlugin(function(){var _this=this;this.textarea.bind(jQuery.browser.opera?"keypress":"keydown",function(e){_this.keys(e);});});jQuery.texyla.extend({keys:function(e){var pressedKey=e.charCode||e.keyCode||-1;var action=false;if(e.ctrlKey&&pressedKey==66&&!e.altKey){this.texy.bold();action=true;}
if(e.ctrlKey&&pressedKey==73){this.texy.italic();action=true;}
if(pressedKey==9&&e.shiftKey){this.texy.unindent();action=true;}
if(pressedKey==9&&!e.shiftKey){if(this.texy.update().text().indexOf(this.texy.lf())==-1){this.texy.tag('\t','');}else{this.texy.indent();}
action=true;}
if(e.ctrlKey&&pressedKey==83){this.submit();action=true;}
if(action){if(e.preventDefault&&e.stopPropagation){e.preventDefault();e.stopPropagation();}else{window.event.cancelBubble=true;window.event.returnValue=false;}}}});jQuery.texyla.initPlugin(function(){if(typeof(this.textarea.resizable)!="function")return;var _this=this;this.textarea.resizable({handles:'s',minHeight:80,stop:function(){_this.textareaHeight=_this.textarea.get(0).offsetHeight;}});this.textarea.parent().css("padding-bottom",0);});jQuery.texyla.addWindow("img",{createContent:function(){return jQuery('<div><table><tbody><tr>'+'<th><label>'+this.lng.imgSrc+'</label></th>'+'<td><input type="text" class="src"></td>'+'</tr><tr>'+'<th><label>'+this.lng.imgAlt+'</label></th>'+'<td><input type="text" class="alt"></td>'+'</tr><tr>'+'<td></td>'+'<td><label><input type="checkbox" class="descr">'+this.lng.imgDescription+'</label></td>'+'</tr><tr>'+'<th><label>'+this.lng.imgAlign+'</label></th>'+'<td><select class="align">'+'<option value="*">'+this.lng.imgAlignNone+'</option>'+'<option value="<">'+this.lng.imgAlignLeft+'</option>'+'<option value=">">'+this.lng.imgAlignRight+'</option>'+'<option value="<>">'+this.lng.imgAlignCenter+'</option>'+'</select></td>'+'</tr></tbody></table></div>');},action:function(el){this.texy.img(el.find(".src").val(),el.find(".alt").val(),el.find(".align").val(),el.find(".descr").get(0).checked);},dimensions:[350,250]});jQuery.texyla.addWindow("table",{dimensions:[320,200],action:function(cont){this.texy.table(cont.find(".cols").val(),cont.find(".rows").val(),cont.find(".header").val());},createContent:function(){var _this=this;var cont=jQuery("<div style='position:relative'>"+'<table class="table"><tbody>'+'<tr><th><label>'+this.lng.tableCols+'</label></th><td><input type="number" class="cols" size="3" maxlength="2" min="1" value="2"></td></tr>'+'<tr><th><label>'+this.lng.tableRows+'</label></th><td><input type="number" class="rows" size="3" maxlength="2" min="1" value="2"></td></tr>'+'<tr><th><label>'+this.lng.tableTh+'</label></th><td><select class="header">'+'<option>'+this.lng.tableThNone+'</option>'+'<option value="n">'+this.lng.tableThTop+'</option>'+'<option value="l">'+this.lng.tableThLeft+'</option>'+'</select></td></tr></tbody></table>'+'<div class="tab-background"><div class="tab-selection"></div><div class="tab-control"></div></div>'+"</div>");var resizing=true,posX,posY;cont.find(".tab-control").click(function(e){resizing=!resizing;}).mousemove(function(e){if(resizing){posX=e.pageX;var el=this;while(el.offsetParent){posX-=el.offsetLeft;el=el.offsetParent;}
posY=e.pageY;el=this;while(el.offsetParent){posY-=el.offsetTop;el=el.offsetParent;}
var cols=Math.ceil(posX/8);var rows=Math.ceil(posY/8);cont.find(".tab-selection").css({width:cols*8,height:rows*8});cont.find(".cols").val(cols);cont.find(".rows").val(rows);}}).dblclick(function(){_this.getWindowAction("table").call(_this,cont);cont.dialog("close");});cont.find(".cols, .rows").bind("change click blur",function(){var cols=Math.min(cont.find(".cols").val(),10);var rows=Math.min(cont.find(".rows").val(),10);cont.find(".tab-selection").css({width:cols*8,height:rows*8});});return cont;}});jQuery.texyla.addWindow("link",{dimensions:[330,180],createContent:function(){return jQuery('<div><table><tbody><tr>'+'<th><label>'+this.lng.linkText+'</label></th>'+'<td><input type="text" class="link-text" value="'+this.texy.trimSelect().text()+'"></td>'+'</tr><tr>'+'<th><label>'+this.lng.linkUrl+'</label></th>'+'<td><input type="text" class="link-url" value="http://"></td>'+'</tr></tbody></table></div>');},action:function(el){var txt=el.find(".link-text").val();txt=txt==''?'':'"'+txt+'":';this.texy.replace(txt+el.find(".link-url").val());}});$.texyla.setDefaults({emoticonPath:"%texyla_base%/emoticons/texy/%var%.gif",emoticons:{':-)':'smile',':-(':'sad',';-)':'wink',':-D':'biggrin','8-O':'eek','8-)':'cool',':-?':'confused',':-x':'mad',':-P':'razz',':-|':'neutral'}});$.texyla.initPlugin(function(){this.options.emoticonPath=this.expand(this.options.emoticonPath);});$.texyla.addWindow("emoticon",{createContent:function(){var _this=this;var emoticons=$('<div></div>');var emoticonsEl=$('<div class="emoticons"></div>').appendTo(emoticons);for(var i in this.options.emoticons){function emClk(emoticon){return function(){_this.texy.replace(emoticon);if(emoticons.find("input.close-after-insert").get(0).checked){emoticons.dialog("close");}}};$("<img src='"+this.options.emoticonPath.replace("%var%",this.options.emoticons[i])+"' title='"+i+"' alt='"+i+"' class='ui-state-default'>").hover(function(){$(this).addClass("ui-state-hover");},function(){$(this).removeClass("ui-state-hover");}).click(emClk(i)).appendTo(emoticonsEl);}
emoticons.append("<br><label><input type='checkbox' checked class='close-after-insert'> "+this.lng.windowCloseAfterInsert+"</label>");return emoticons;},dimensions:[192,170]});jQuery.texyla.setDefaults({symbols:["&","@",["<","&lt;"],[">","&gt;"],"[","]","{","}","\\","α","β","π","µ","Ω","∑","°","∞","≠","±","×","÷","≥","≤","®","™","€","£","$","~","^","·","•"]});jQuery.texyla.addWindow("symbol",{dimensions:[300,230],createContent:function(){var _this=this;var el=jQuery('<div></div>');var symbolsEl=jQuery('<div class="symbols"></div>').appendTo(el);var symbols=this.options.symbols;for(var i=0;i<symbols.length;i++){function clk(text){return function(){_this.texy.replace(text);if(el.find("input.close-after-insert").get(0).checked){el.dialog("close");}}};jQuery("<span class='ui-state-default'></span>").hover(function(){jQuery(this).addClass("ui-state-hover");},function(){jQuery(this).removeClass("ui-state-hover");}).text(symbols[i]instanceof Array?symbols[i][0]:symbols[i]).click(clk(symbols[i]instanceof Array?symbols[i][1]:symbols[i])).appendTo(symbolsEl);}
el.append("<br><label><input type='checkbox' checked class='close-after-insert'> "+
this.lng.windowCloseAfterInsert+"</label>");return el;}});jQuery.texyla.setDefaults({filesPath:null,filesThumbPath:'%var%',filesIconPath:"%texyla_base%/plugins/files/icons/%var%.png",filesUploadPath:null,filesMkDirPath:null,filesRenamePath:null,filesDeletePath:null,filesAllowUpload:true,filesAllowMkDir:false,filesAllowDelete:true,filesAllowDeleteDir:false,filesAllowRename:true,filesAllowRenameDir:false,filesAllowFilter:true});jQuery.texyla.initPlugin(function(){this.options.filesPath=this.expand(this.options.filesPath);if(this.options.filesThumbPath)
this.options.filesThumbPath=this.expand(this.options.filesThumbPath);if(this.options.filesUploadPath)
this.options.filesUploadPath=this.expand(this.options.filesUploadPath);if(this.options.filesMkDirPath)
this.options.filesMkDirPath=this.expand(this.options.filesMkDirPath);if(this.options.filesRenamePath)
this.options.filesRenamePath=this.expand(this.options.filesRenamePath);if(this.options.filesDeletePath)
this.options.filesDeletePath=this.expand(this.options.filesDeletePath);});jQuery.texyla.addWindow("files",{dimensions:[400,350],createContent:function(){var _this=this;var currentDir="";var el=jQuery('<div>'+'<div class="toolbar"></div>'+'<div class="files-gallery"></div>'+'<p class="wait">'+this.lng.wait+'</p>'+'</div>');if(this.options.filesAllowUpload){jQuery('<a href="" class="upload">'+this.lng.filesUpload+'</a>').button({icons:{primary:"ui-icon-arrowthick-1-n"}}).click(function(){var win=_this.openWindow("upload");win.find("form input.folder").val(currentDir);el.dialog("close");return false;}).appendTo(el.find("div.toolbar"));}
if(this.options.filesAllowMkDir){jQuery('<a href="" class="mkdir">'+this.lng.filesMkDir+'</a>').button({icons:{primary:"ui-icon-folder-collapsed"}}).click(function(){var name=prompt(_this.lng.filesDirectoryName,"");if(!name)return false;jQuery.getJSON(_this.options.filesMkDirPath,{folder:currentDir,name:name},function(data){if(data.error){_this.error(data.error);return;}
loadList(currentDir);});return false;}).appendTo(el.find("div.toolbar"));}
if(this.options.filesAllowFilter){jQuery('<div class="files-filter">'+this.lng.filesFilter+': <input type="text" class="ui-widget-content"></div>').insertAfter(el.find(".toolbar"));var gallery=el.find("div.files-gallery");el.find("div.files-filter input").keyup(function(){var val=this.value;gallery.find(".gallery-item").each(function(){var item=$(this);if(val===""){item.show();return;}
if(item.find("span.name").text().indexOf(val)!==-1){item.show();}else{item.hide();}});});}
function loadList(dir){currentDir=dir;el.find("p.wait").show();el.find("div.toolbar, div.files-filter, div.files-gallery").hide();jQuery.ajax({type:"GET",dataType:"json",cache:false,url:_this.options.filesPath,data:{folder:currentDir},success:function(data){if(data.error){_this.error(data.error);return;}
el.find("p.wait").hide();el.find("div.toolbar, div.files-filter, div.files-gallery").show();gallery.empty();var list=data.list;for(var i=0;i<list.length;i++){var type=list[i].type;var item=jQuery('<table class="gallery-item ui-widget-content ui-corner-all"><tr>'+'<td class="image"></td><td class="label"></td>'+'</tr></table>').appendTo(gallery);if(type==="image"){item.find(".image").append('<image src="'+_this.expand(_this.options.filesThumbPath,list[i].thumbnailKey)+'">');}else{item.find(".image").append('<img src="'+_this.expand(_this.options.filesIconPath,list[i].type)+'" width="16" height="16" alt="">');}
item.find(".label").append('<span class="name"><a href="">'+list[i].name+'</a></span>');if(list[i].description){item.find(".label").append('<br><small class="description">'+list[i].description+'</small>');}
var fnc;switch(type){case"up":case"folder":fnc=function(dir){return function(){loadList(dir.key)
return false;}}(list[i]);break;case"image":fnc=function(img){return function(){var winEl=_this.openWindow("img");winEl.find(".src").val(img.insertUrl);winEl.find(".alt").val(img.description).select();el.dialog("close");return false;}}(list[i]);break;case"file":fnc=function(file){return function(){var winEl=_this.openWindow("link");winEl.find(".link-url").val(file.insertUrl);winEl.find(".link-text").val(file.description).select();el.dialog("close");return false;}}(list[i]);break;}
item.find(".image img").click(fnc);item.find(".label span.name a").click(fnc);if(type!=="up"){var buttons=jQuery('<td class="buttons"></td>').appendTo(item.find("tr"));if((_this.options.filesAllowRename&&(type==="file"||type=="image"))||(_this.options.filesAllowRenameDir&&type==="folder")){jQuery('<a href="" class="rename">'+_this.lng.filesRename+'</a>').button({icons:{primary:"ui-icon-pencil"},text:false}).click(function(file){return function(){var newname=prompt(_this.lng.filesRename,file.name);if(!newname)return false;jQuery.getJSON(_this.options.filesRenamePath,{folder:currentDir,oldname:file.name,newname:newname},function(data){if(data.error){_this.error(data.error);return;}
loadList(currentDir);});return false;}}(list[i])).appendTo(buttons);}
if((_this.options.filesAllowDelete&&(type==="file"||type=="image"))||(_this.options.filesAllowDeleteDir&&type==="folder")){jQuery('<a href="" class="delete">'+_this.lng.filesDelete+'</a>').button({icons:{primary:"ui-icon-closethick"},text:false}).click(function(file){return function(){if(!confirm(_this.lng.filesReallyDelete+" '"+file.name+"'?"))return false;jQuery.getJSON(_this.options.filesDeletePath,{folder:currentDir,name:file.name},function(data){if(data.error){_this.error(data.error);return;}
loadList(currentDir);});return false;}}(list[i])).appendTo(buttons);}}}}});}
loadList("");return el;}});jQuery.texyla.addWindow("upload",{dimensions:[330,160],createContent:function(){return jQuery('<div>'+'<form action="'+this.options.filesUploadPath+'" class="upload" method="post" enctype="multipart/form-data"><div>'+'<input type="hidden" name="folder" class="folder" value="">'+'<input type="file" name="file" class="file"> '+'</div></form>'+'<p class="wait" style="display:none">'+this.lng.wait+'</p>'+'</div>');},action:function(el){var upload=el.find("form");if(!upload.find(".file").val())return;el.ajaxStart(function(){upload.hide();el.find("p.wait").show();}).ajaxComplete(function(){el.dialog("close");});var _this=this;upload.ajaxUpload(function(data){if(data.error){_this.error(data.error);}else{if(data.type=="image"){var imgWin=_this.openWindow("img");imgWin.find(".src").val(data.filename);imgWin.find(".alt").focus();}else{var linkWin=_this.openWindow("link");linkWin.find(".link-url").val(data.filename);linkWin.find(".link-text").focus();}}});}});jQuery.texyla.setDefaults({colors:['red','blue','aqua','black','fuchsia','gray','green','lime','maroon','navy','olive','orange','purple','silver','teal','white','yellow','#AABBCC']});jQuery.texyla.addWindow("color",{createContent:function(){var _this=this;var colors=jQuery('<div></div>');var colorsEl=jQuery('<div class="colors"></div>').appendTo(colors);function colorClk(color){return function(){_this.texy.update();if(_this.texy.isCursor()){_this.texy.selectBlock().phrase('',' .{color: '+color+'}');}else{_this.texy.phrase('"',' .{color: '+color+'}"');}
if(colors.find("input.close-after-insert").get(0).checked){colors.dialog("close");}}}
for(var i=0;i<_this.options.colors.length;i++){var color=_this.options.colors[i];jQuery('<span class="ui-state-default ui-corner-all" title="'+color+'">'+'<span style="background-color:'+color+'">&nbsp;</span>'+'</span>').hover(function(){jQuery(this).addClass("ui-state-hover");},function(){jQuery(this).removeClass("ui-state-hover");}).click(colorClk(color)).appendTo(colorsEl);}
colors.append("<br><label><input type='checkbox' checked class='close-after-insert'> "+
this.lng.windowCloseAfterInsert+"</label>");return colors;},dimensions:[200,150]});jQuery.texyla.addWindow("textTransform",{createContent:function(){return jQuery("<div><form>"+"<label><input type='radio' name='changeCase' value='lower'> "+this.lng.textTransformLower+"</label><br>"+"<label><input type='radio' name='changeCase' value='upper'> "+this.lng.textTransformUpper+"</label><br>"+"<label><input type='radio' name='changeCase' value='firstUpper'> "+this.lng.textTransformFirstUpper+"</label><br>"+"<label><input type='radio' name='changeCase' value='cap'> "+this.lng.textTransformCapitalize+"</label><br>"+"<label><input type='radio' name='changeCase' value='url'> "+this.lng.textTransformUrl+"</label>"+"</form></div>");},action:function(el){var text=this.texy.update().text();var newText=null;var transformation=el.find("form input:checked").val();switch(transformation){case"lower":newText=text.toLowerCase();break;case"upper":newText=text.toUpperCase();break;case"cap":newText=text.replace(/\S+/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1,a.length).toLowerCase();});break;case"firstUpper":newText=text.charAt(0).toUpperCase()+text.substr(1,text.length).toLowerCase();break;case"url":var nodiac={'á':'a','č':'c','ď':'d','é':'e','ě':'e','í':'i','ň':'n','ó':'o','ř':'r','š':'s','ť':'t','ú':'u','ů':'u','ý':'y','ž':'z'};var s=text.toLowerCase();var s2='';for(var i=0;i<s.length;i++){s2+=(typeof nodiac[s.charAt(i)]!='undefined'?nodiac[s.charAt(i)]:s.charAt(i));}
newText=s2.replace(/[^a-z0-9_]+/g,'-').replace(/^-|-$/g,'');break;default:}
if(newText!==null){this.texy.replace(newText);}},dimensions:[220,210]});jQuery.texyla.setDefaults({youtubeMakro:"[* youtube:%var% *]"});jQuery.texyla.addWindow("youtube",{createContent:function(){var el=jQuery("<div><form><div>"+'<label>'+this.lng.youtubeUrl+'<br>'+'<input type="text" size="35" class="key">'+"</label><br><br>"+
this.lng.youtubePreview+'</div>'+'<div class="thumb"></div>'+"</form></div>");el.find(".key").bind("keyup change",function(){var val=this.value;var key="";if(val.substr(0,7)=="http://"){var res=val.match("[?&]v=([a-zA-Z0-9_-]+)");if(res)key=res[1];}else{key=val;}
jQuery(this).data("key",key);el.find(".thumb").html('<img src="http://img.youtube.com/vi/'+key+'/1.jpg" width="120" height="90">');});return el;},action:function(el){var txt=this.expand(this.options.youtubeMakro,el.find(".key").data("key"));this.texy.update().replace(txt);},dimensions:[320,300]});jQuery.texyla.addStrings("cs",{});jQuery.texyla.setDefaults({gravatarMakro:'[* gravatar:%var% *]'});jQuery.texyla.addWindow('gravatar',{createContent:function(){var el=jQuery('<div><form><div>'+'<label>'+this.lng.gravatarUrl+'<br>'+'<input type="text" size="20" class="key">'+"</label><br><br>"+
this.lng.gravatarPreview+'</div>'+'<div class="thumb"></div>'+"</form></div>");el.find('.key').bind('keyup change',function(){var val=this.value;if(!(/^[^@\s]+@[^@\s]+\.[a-z]{2,10}$/i).test(val)){return;}
jQuery(this).data('key',val);el.find('.thumb').html('<img src="http://www.gravatar.com/avatar/'+faultylabs.MD5(val.trim().toLowerCase()).toLowerCase()+'?d=mm&s=32" width="32" height="32">');});return el;},action:function(el){var txt=this.expand(this.options.gravatarMakro,el.find('.key').data('key'));this.texy.update().replace(txt);},dimensions:[320,'auto']});jQuery.texyla.addStrings('cs',{});if(typeof faultylabs=='undefined'){faultylabs={}}
faultylabs.MD5=function(data){function to_zerofilled_hex(n){var t1=(n>>>0).toString(16)
return"00000000".substr(0,8-t1.length)+t1}
function chars_to_bytes(ac){var retval=[]
for(var i=0;i<ac.length;i++){retval=retval.concat(str_to_bytes(ac[i]))}
return retval}
function int64_to_bytes(num){var retval=[]
for(var i=0;i<8;i++){retval.push(num&0xFF)
num=num>>>8}
return retval}
function rol(num,places){return((num<<places)&0xFFFFFFFF)|(num>>>(32-places))}
function fF(b,c,d){return(b&c)|(~b&d)}
function fG(b,c,d){return(d&b)|(~d&c)}
function fH(b,c,d){return b^c^d}
function fI(b,c,d){return c^(b|~d)}
function bytes_to_int32(arr,off){return(arr[off+3]<<24)|(arr[off+2]<<16)|(arr[off+1]<<8)|(arr[off])}
function str_to_bytes(str){var retval=[]
for(var i=0;i<str.length;i++)
if(str.charCodeAt(i)<=0x7F){retval.push(str.charCodeAt(i))}else{var tmp=encodeURIComponent(str.charAt(i)).substr(1).split('%')
for(var j=0;j<tmp.length;j++){retval.push(parseInt(tmp[j],0x10))}}
return retval}
function int128le_to_hex(a,b,c,d){var ra=""
var t=0
var ta=0
for(var i=3;i>=0;i--){ta=arguments[i]
t=(ta&0xFF)
ta=ta>>>8
t=t<<8
t=t|(ta&0xFF)
ta=ta>>>8
t=t<<8
t=t|(ta&0xFF)
ta=ta>>>8
t=t<<8
t=t|ta
ra=ra+to_zerofilled_hex(t)}
return ra}
function typed_to_plain(tarr){var retval=new Array(tarr.length)
for(var i=0;i<tarr.length;i++){retval[i]=tarr[i]}
return retval}
var databytes=null
var type_mismatch=null
if(typeof data=='string'){databytes=str_to_bytes(data)}else if(data.constructor==Array){if(data.length===0){databytes=data}else if(typeof data[0]=='string'){databytes=chars_to_bytes(data)}else if(typeof data[0]=='number'){databytes=data}else{type_mismatch=typeof data[0]}}else if(typeof ArrayBuffer!='undefined'){if(data instanceof ArrayBuffer){databytes=typed_to_plain(new Uint8Array(data))}else if((data instanceof Uint8Array)||(data instanceof Int8Array)){databytes=typed_to_plain(data)}else if((data instanceof Uint32Array)||(data instanceof Int32Array)||(data instanceof Uint16Array)||(data instanceof Int16Array)||(data instanceof Float32Array)||(data instanceof Float64Array)){databytes=typed_to_plain(new Uint8Array(data.buffer))}else{type_mismatch=typeof data}}else{type_mismatch=typeof data}
if(type_mismatch){alert('MD5 type mismatch, cannot process '+type_mismatch)}
function _add(n1,n2){return 0x0FFFFFFFF&(n1+n2)}
return do_digest()
function do_digest(){function updateRun(nf,sin32,dw32,b32){var temp=d
d=c
c=b
b=_add(b,rol(_add(a,_add(nf,_add(sin32,dw32))),b32))
a=temp}
var org_len=databytes.length
databytes.push(0x80)
var tail=databytes.length%64
if(tail>56){for(var i=0;i<(64-tail);i++){databytes.push(0x0)}
tail=databytes.length%64}
for(i=0;i<(56-tail);i++){databytes.push(0x0)}
databytes=databytes.concat(int64_to_bytes(org_len*8))
var h0=0x67452301
var h1=0xEFCDAB89
var h2=0x98BADCFE
var h3=0x10325476
var a=0,b=0,c=0,d=0
for(i=0;i<databytes.length/64;i++){a=h0
b=h1
c=h2
d=h3
var ptr=i*64
updateRun(fF(b,c,d),0xd76aa478,bytes_to_int32(databytes,ptr),7)
updateRun(fF(b,c,d),0xe8c7b756,bytes_to_int32(databytes,ptr+4),12)
updateRun(fF(b,c,d),0x242070db,bytes_to_int32(databytes,ptr+8),17)
updateRun(fF(b,c,d),0xc1bdceee,bytes_to_int32(databytes,ptr+12),22)
updateRun(fF(b,c,d),0xf57c0faf,bytes_to_int32(databytes,ptr+16),7)
updateRun(fF(b,c,d),0x4787c62a,bytes_to_int32(databytes,ptr+20),12)
updateRun(fF(b,c,d),0xa8304613,bytes_to_int32(databytes,ptr+24),17)
updateRun(fF(b,c,d),0xfd469501,bytes_to_int32(databytes,ptr+28),22)
updateRun(fF(b,c,d),0x698098d8,bytes_to_int32(databytes,ptr+32),7)
updateRun(fF(b,c,d),0x8b44f7af,bytes_to_int32(databytes,ptr+36),12)
updateRun(fF(b,c,d),0xffff5bb1,bytes_to_int32(databytes,ptr+40),17)
updateRun(fF(b,c,d),0x895cd7be,bytes_to_int32(databytes,ptr+44),22)
updateRun(fF(b,c,d),0x6b901122,bytes_to_int32(databytes,ptr+48),7)
updateRun(fF(b,c,d),0xfd987193,bytes_to_int32(databytes,ptr+52),12)
updateRun(fF(b,c,d),0xa679438e,bytes_to_int32(databytes,ptr+56),17)
updateRun(fF(b,c,d),0x49b40821,bytes_to_int32(databytes,ptr+60),22)
updateRun(fG(b,c,d),0xf61e2562,bytes_to_int32(databytes,ptr+4),5)
updateRun(fG(b,c,d),0xc040b340,bytes_to_int32(databytes,ptr+24),9)
updateRun(fG(b,c,d),0x265e5a51,bytes_to_int32(databytes,ptr+44),14)
updateRun(fG(b,c,d),0xe9b6c7aa,bytes_to_int32(databytes,ptr),20)
updateRun(fG(b,c,d),0xd62f105d,bytes_to_int32(databytes,ptr+20),5)
updateRun(fG(b,c,d),0x2441453,bytes_to_int32(databytes,ptr+40),9)
updateRun(fG(b,c,d),0xd8a1e681,bytes_to_int32(databytes,ptr+60),14)
updateRun(fG(b,c,d),0xe7d3fbc8,bytes_to_int32(databytes,ptr+16),20)
updateRun(fG(b,c,d),0x21e1cde6,bytes_to_int32(databytes,ptr+36),5)
updateRun(fG(b,c,d),0xc33707d6,bytes_to_int32(databytes,ptr+56),9)
updateRun(fG(b,c,d),0xf4d50d87,bytes_to_int32(databytes,ptr+12),14)
updateRun(fG(b,c,d),0x455a14ed,bytes_to_int32(databytes,ptr+32),20)
updateRun(fG(b,c,d),0xa9e3e905,bytes_to_int32(databytes,ptr+52),5)
updateRun(fG(b,c,d),0xfcefa3f8,bytes_to_int32(databytes,ptr+8),9)
updateRun(fG(b,c,d),0x676f02d9,bytes_to_int32(databytes,ptr+28),14)
updateRun(fG(b,c,d),0x8d2a4c8a,bytes_to_int32(databytes,ptr+48),20)
updateRun(fH(b,c,d),0xfffa3942,bytes_to_int32(databytes,ptr+20),4)
updateRun(fH(b,c,d),0x8771f681,bytes_to_int32(databytes,ptr+32),11)
updateRun(fH(b,c,d),0x6d9d6122,bytes_to_int32(databytes,ptr+44),16)
updateRun(fH(b,c,d),0xfde5380c,bytes_to_int32(databytes,ptr+56),23)
updateRun(fH(b,c,d),0xa4beea44,bytes_to_int32(databytes,ptr+4),4)
updateRun(fH(b,c,d),0x4bdecfa9,bytes_to_int32(databytes,ptr+16),11)
updateRun(fH(b,c,d),0xf6bb4b60,bytes_to_int32(databytes,ptr+28),16)
updateRun(fH(b,c,d),0xbebfbc70,bytes_to_int32(databytes,ptr+40),23)
updateRun(fH(b,c,d),0x289b7ec6,bytes_to_int32(databytes,ptr+52),4)
updateRun(fH(b,c,d),0xeaa127fa,bytes_to_int32(databytes,ptr),11)
updateRun(fH(b,c,d),0xd4ef3085,bytes_to_int32(databytes,ptr+12),16)
updateRun(fH(b,c,d),0x4881d05,bytes_to_int32(databytes,ptr+24),23)
updateRun(fH(b,c,d),0xd9d4d039,bytes_to_int32(databytes,ptr+36),4)
updateRun(fH(b,c,d),0xe6db99e5,bytes_to_int32(databytes,ptr+48),11)
updateRun(fH(b,c,d),0x1fa27cf8,bytes_to_int32(databytes,ptr+60),16)
updateRun(fH(b,c,d),0xc4ac5665,bytes_to_int32(databytes,ptr+8),23)
updateRun(fI(b,c,d),0xf4292244,bytes_to_int32(databytes,ptr),6)
updateRun(fI(b,c,d),0x432aff97,bytes_to_int32(databytes,ptr+28),10)
updateRun(fI(b,c,d),0xab9423a7,bytes_to_int32(databytes,ptr+56),15)
updateRun(fI(b,c,d),0xfc93a039,bytes_to_int32(databytes,ptr+20),21)
updateRun(fI(b,c,d),0x655b59c3,bytes_to_int32(databytes,ptr+48),6)
updateRun(fI(b,c,d),0x8f0ccc92,bytes_to_int32(databytes,ptr+12),10)
updateRun(fI(b,c,d),0xffeff47d,bytes_to_int32(databytes,ptr+40),15)
updateRun(fI(b,c,d),0x85845dd1,bytes_to_int32(databytes,ptr+4),21)
updateRun(fI(b,c,d),0x6fa87e4f,bytes_to_int32(databytes,ptr+32),6)
updateRun(fI(b,c,d),0xfe2ce6e0,bytes_to_int32(databytes,ptr+60),10)
updateRun(fI(b,c,d),0xa3014314,bytes_to_int32(databytes,ptr+24),15)
updateRun(fI(b,c,d),0x4e0811a1,bytes_to_int32(databytes,ptr+52),21)
updateRun(fI(b,c,d),0xf7537e82,bytes_to_int32(databytes,ptr+16),6)
updateRun(fI(b,c,d),0xbd3af235,bytes_to_int32(databytes,ptr+44),10)
updateRun(fI(b,c,d),0x2ad7d2bb,bytes_to_int32(databytes,ptr+8),15)
updateRun(fI(b,c,d),0xeb86d391,bytes_to_int32(databytes,ptr+36),21)
h0=_add(h0,a)
h1=_add(h1,b)
h2=_add(h2,c)
h3=_add(h3,d)}
return int128le_to_hex(h3,h2,h1,h0).toUpperCase()}}
$.texyla.setDefaults({baseDir:'http://www.oobtrebic.cz/js/texyla',previewPath:'/texyla/preview',filesPath:'{{$filesPath}}',filesUploadPath:'{{$filesUploadPath}}',filesMkDirPath:'{{$filesMkDirPath}}',filesRenamePath:'{{$filesRenamePath}}',filesDeletePath:'{{$filesDeletePath}}'});$(function(){$("textarea.texyla").livequery(function(){$(this).texyla({toolbar:['h2','h3','h4',null,'bold','italic',null,'ul','ol',null,'link','img','table',null,'color',null,],texyCfg:$(this).data('texy-cfg'),bottomLeftToolbar:['edit','preview'],bottomRightPreviewToolbar:[],buttonType:"span",tabs:false});});$.texyla({buttonType:"button"});});